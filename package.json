{
  "name": "weftend",
  "version": "0.0.0",
  "private": true,
  "scripts": {
    "compile": "tsc --pretty false",
    "test": "npm run compile --silent && node dist/src/core/canon.test.js && node dist/src/core/validate.test.js && node dist/src/engine/graph.test.js && node dist/src/runtime/classify/artifact_kind_v0.test.js && node dist/src/runtime/host/host_runner.test.js && node dist/src/runtime/host/host_update.test.js && node dist/src/runtime/host/host_status.test.js && node dist/src/runtime/host/host_cli_smoke.test.js && node dist/src/runtime/host/host_update_cli_smoke.test.js && node dist/src/runtime/redteam/stamp_forgery.test.js && node dist/src/runtime/redteam/policy_tamper.test.js && node dist/src/runtime/redteam/downgrade_truth.test.js && node dist/src/runtime/redteam/boundary_spoof_replay.test.js && node dist/src/engine/redteam/evidence_swap.test.js && node dist/src/core/redteam/secret_smuggling_and_leak.test.js && node dist/src/runtime/purpleteam/purple_baseline_block_flow.test.js && node dist/src/runtime/purpleteam/purple_compare_signal.test.js && node dist/src/runtime/purpleteam/purple_no_silent_pass.test.js && node dist/src/cli/blueteam/exit_code_contract.test.js && node dist/src/cli/blueteam/report_card_contract.test.js && node dist/src/cli/blueteam/library_command_contract.test.js && node dist/src/core/orangeteam/no_auto_keygen.test.js && node dist/src/core/orangeteam/receipt_privacy_contract.test.js && node dist/src/tools/greenteam/release_artifacts_present.test.js && node dist/src/tools/greenteam/release_bundle_manifest.test.js && node dist/src/runtime/privacy_lint.test.js && node dist/src/tools/windows_shell_assets.test.js && node dist/src/cli/run_cli_smoke.test.js && node dist/src/cli/safe_run_cli_smoke.test.js && node dist/src/cli/library_cli_smoke.test.js && node dist/src/cli/library_state.test.js && node dist/src/cli/compare.test.js && node dist/src/cli/compare_cli_smoke.test.js && node dist/src/cli/license_cli_smoke.test.js && node dist/src/cli/ticket_pack.test.js",
    "weftend": "node dist/src/cli/main.js",
    "clean": "node -e \"require('fs').rmSync('dist',{recursive:true,force:true});\"",
    "proofcheck": "npm run compile --silent && node -e \"const fs=require('fs');const path=require('path');const {spawnSync}=require('child_process');const root=process.cwd();const distDir=path.join(root,'dist');if(!fs.existsSync(distDir)){console.error('Missing dist directory after compile.');process.exit(1);}const collect=(dir)=>{const out=[];for(const entry of fs.readdirSync(dir,{withFileTypes:true})){const full=path.join(dir,entry.name);if(entry.isDirectory())out.push(...collect(full));else out.push(full);}return out;};const srcDir=path.join(root,'src');const srcFiles=collect(srcDir).filter(f=>f.endsWith('.ts'));const expected=new Set(srcFiles.map(f=>path.join(distDir,path.relative(root,f)).replace(/\\.ts$/,'.js')));const distFiles=collect(distDir).filter(f=>f.endsWith('.js'));const extras=distFiles.filter(f=>!expected.has(f));if(extras.length>0){console.error('DIST_DIR_HAS_EXTRA_OUTPUTS:');extras.slice(0,25).forEach(f=>console.error(f));process.exit(1);}const allowSkip=process.env.WEFTEND_ALLOW_SKIP_RELEASE==='1';const hasRelease=Boolean(process.env.WEFTEND_RELEASE_DIR);const skipReceipt='SKIP_RECEIPT: RELEASE_SMOKE_SKIPPED reason=WEFTEND_RELEASE_DIR_NOT_SET allow=WEFTEND_ALLOW_SKIP_RELEASE';if(!hasRelease&&!allowSkip){console.error('Missing WEFTEND_RELEASE_DIR (set it or run with WEFTEND_ALLOW_SKIP_RELEASE=1).');process.exit(1);}if(!hasRelease&&allowSkip){console.error(skipReceipt);console.error('WEFTEND_RELEASE_DIR not set; release smoke will SKIP.');}const tests=['dist/src/core/canon.test.js','dist/src/core/validate.test.js','dist/src/core/build_boundary.test.js','dist/src/core/build_boundary_shadow_modules.test.js','dist/src/core/mint_package_v1.test.js','dist/src/core/intake_policy_v1.test.js','dist/src/core/trust_algebra_v0.test.js','dist/src/core/redteam/secret_smuggling_and_leak.test.js','dist/src/runtime/purpleteam/purple_baseline_block_flow.test.js','dist/src/runtime/purpleteam/purple_compare_signal.test.js','dist/src/runtime/purpleteam/purple_no_silent_pass.test.js','dist/src/cli/blueteam/exit_code_contract.test.js','dist/src/cli/blueteam/report_card_contract.test.js','dist/src/cli/blueteam/library_command_contract.test.js','dist/src/core/orangeteam/no_auto_keygen.test.js','dist/src/core/orangeteam/receipt_privacy_contract.test.js','dist/src/tools/greenteam/release_artifacts_present.test.js','dist/src/tools/greenteam/release_bundle_manifest.test.js','dist/src/engine/graph.test.js','dist/src/engine/portal_model.test.js','dist/src/engine/portal_model_caps.test.js','dist/src/engine/release_manifest.test.js','dist/src/engine/redteam/evidence_swap.test.js','dist/src/runtime/classify/artifact_kind_v0.test.js','dist/src/runtime/release/release_loader.test.js','dist/src/runtime/store/artifact_store.test.js','dist/src/runtime/strict/strict_executor.test.js','dist/src/runtime/host/host_runner.test.js','dist/src/runtime/host/host_update.test.js','dist/src/runtime/host/host_status.test.js','dist/src/runtime/host/host_cli_smoke.test.js','dist/src/runtime/host/host_update_cli_smoke.test.js','dist/src/runtime/redteam/stamp_forgery.test.js','dist/src/runtime/redteam/policy_tamper.test.js','dist/src/runtime/redteam/downgrade_truth.test.js','dist/src/runtime/redteam/boundary_spoof_replay.test.js','dist/src/runtime/privacy_lint.test.js','dist/src/tools/windows_shell_assets.test.js','dist/src/runtime/examiner/examine_determinism.test.js','dist/src/runtime/examiner/examine_caps_probe.test.js','dist/src/runtime/examiner/examine_external_refs.test.js','dist/src/runtime/examiner/examine_golden.test.js','dist/src/runtime/examiner/mod_profile_fixture.test.js','dist/src/runtime/examiner/intake_decision_v1_golden.test.js','dist/src/runtime/examiner/intake_decision_v1.test.js','dist/src/runtime/probe/probe_strict_v0.test.js','dist/src/runtime/probe/probe_unhandled_rejection.test.js','dist/src/cli/intake_cli_smoke.test.js','dist/src/cli/inspect_compile_smoke.test.js','dist/src/cli/run_cli_smoke.test.js','dist/src/cli/safe_run_cli_smoke.test.js','dist/src/cli/library_cli_smoke.test.js','dist/src/cli/library_state.test.js','dist/src/cli/compare.test.js','dist/src/cli/compare_cli_smoke.test.js','dist/src/cli/license_cli_smoke.test.js','dist/src/cli/ticket_pack.test.js','harness_session_v0.test.js','test/harness/clinic_v1_golden.test.js','test/harness/clinic_v1_release_smoke.test.js','test/harness/ui_gatepack.test.js'];for(const t of tests){if(!fs.existsSync(t)){console.error('Missing test file:',t);process.exit(1);}const r=spawnSync(process.execPath,[t],{stdio:'inherit'});if(r.status!==0){process.exit(r.status||1);}}const lint=spawnSync(process.execPath,['dist/src/runtime/privacy_lint.js','out'],{stdio:'inherit'});if(lint.status!==0){process.exit(lint.status||1);}console.log(`proofcheck: PASS${!hasRelease&&allowSkip?` | ${skipReceipt}`:''}`);\"",
    "loop": "node -e \"const {spawnSync}=require('child_process');const env={...process.env,WEFTEND_ALLOW_SKIP_RELEASE:'1'};const npmCli=env.npm_execpath||'';if(!npmCli){console.error('Missing npm_execpath.');process.exit(1);}const run=(args)=>{const r=spawnSync(process.execPath,[npmCli,...args],{stdio:'inherit',env});if(r.status!==0)process.exit(r.status||1);};run(['run','compile','--silent']);run(['test']);run(['run','proofcheck']);\"",
    "clean-loop": "node -e \"const {spawnSync}=require('child_process');const env={...process.env,WEFTEND_ALLOW_SKIP_RELEASE:'1'};const npmCli=env.npm_execpath||'';if(!npmCli){console.error('Missing npm_execpath.');process.exit(1);}const run=(args)=>{const r=spawnSync(process.execPath,[npmCli,...args],{stdio:'inherit',env});if(r.status!==0)process.exit(r.status||1);};run(['run','clean']);run(['run','loop']);\"",
    "release-loop": "node -e \"const {spawnSync}=require('child_process');const env={...process.env};if(!env.WEFTEND_RELEASE_DIR){console.error('Missing WEFTEND_RELEASE_DIR. Set it to a release folder path before running npm run release-loop.');process.exit(1);}const npmCli=env.npm_execpath||'';if(!npmCli){console.error('Missing npm_execpath.');process.exit(1);}console.log(`WEFTEND_RELEASE_DIR=${env.WEFTEND_RELEASE_DIR}`);const run=(args)=>{const r=spawnSync(process.execPath,[npmCli,...args],{stdio:'inherit',env});if(r.status!==0)process.exit(r.status||1);};run(['run','compile','--silent']);run(['test']);run(['run','proofcheck']);\""
  },
  "devDependencies": {
    "typescript": "^5.6.3"
  }
}
