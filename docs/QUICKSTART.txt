WeftEnd Quickstart (5 minutes)

What WeftEnd is (short)
- Deterministic evidence + change tracking + change control.
- Compare against a baseline to see what changed.
- Privacy-clean outputs you can attach to tickets.
See docs/WHAT_IS_WEFTEND.md and docs/WHY_RECEIPTS.md for details.

1) Install (Windows, per-user)
- Run tools\windows\INSTALL_WINDOWS.cmd
- This installs right-click entries and runs shell doctor checks.
- Start Menu shortcuts installed by default:
  - WeftEnd Launchpad
  - WeftEnd Download
- Cross-platform note: CLI works on Windows/macOS/Linux (Node.js required).
- Windows shell integration is Windows-only.

2) First run (right-click)
- Right-click any file or folder -> Run with WeftEnd
- Report card opens in the WeftEnd viewer by default.
- Native binaries are WITHHELD by design (analysis-first).
- webLane=NOT_APPLICABLE is normal for non-web artifacts.
- On CHANGED runs, review delta= and SIGNAL lines before accepting baseline.

3) Compare (optional)
- Run again after any change.
- Use:
  npm run weftend -- compare <oldOut> <newOut> --out <diffOut>
- Read compare_report.txt

3.1) Universal artifact adapter lane (CLI)
- List adapter coverage:
  npm run weftend -- adapter list
- Check adapter dependency and maintenance status:
  npm run weftend -- adapter doctor
  npm run weftend -- adapter doctor --text
  npm run weftend -- adapter doctor --strict
  npm run weftend -- adapter doctor --write-policy policies/adapter_maintenance.json
  npm run weftend -- adapter doctor --write-policy policies/adapter_maintenance.json --include-missing-plugins
  Note: `--include-missing-plugins` is valid only with `--write-policy`.
- Run safe-run with adapter auto-detect:
  npm run weftend -- safe-run <input> --out <dir> --adapter auto
- Force a specific adapter:
  npm run weftend -- safe-run <input> --out <dir> --adapter archive
- Enable optional local plugin explicitly when needed:
  npm run weftend -- safe-run <input> --out <dir> --adapter archive --enable-plugin tar
- Adapter artifacts (when adapter is applied):
  analysis/capability_ledger_v0.json
  analysis/adapter_summary_v0.json
  analysis/adapter_findings_v0.json
- Report viewer UI (when adapter evidence exists):
  - `Show Adapter Evidence` toggle reveals adapter class/mode, capability counts, and quick-open buttons for capability/summary/findings artifacts.
- Launchpad History UI:
  - `Adapter` column shows adapter tag from latest run (`+plugin` marker and `!` marker when denied capabilities are present).
- Optional maintenance gate:
  - Set WEFTEND_ADAPTER_DISABLE to disable adapter lanes temporarily.
  - Example: WEFTEND_ADAPTER_DISABLE=archive,package
  - Use WEFTEND_ADAPTER_DISABLE=all to disable all adapter lanes.
  - Optional file policy: WEFTEND_ADAPTER_DISABLE_FILE=<path-to-json> with {"disabledAdapters":["archive","container"]}.
  - Template: policies/adapter_maintenance.example.json (details in docs/ADAPTER_MAINTENANCE_POLICY.md).
  - Disabled lane result is fail-closed (ADAPTER_TEMPORARILY_UNAVAILABLE).
  - Invalid disable token is fail-closed (ADAPTER_POLICY_INVALID).
  - Fail-closed adapter-policy outcomes still write deterministic safe-run evidence artifacts.

3.2) Container scan (CLI, local Docker inspect only)
- Scan a locally available immutable image reference:
  npm run weftend -- container scan <image@sha256:...|sha256:...> --out <dir>
- This lane is local-only and fail-closed:
  - Requires immutable digest refs (no mutable tag refs like `:latest`)
  - No docker pull
  - No registry auth
  - No implicit network activity
  - Honors adapter maintenance policy (`WEFTEND_ADAPTER_DISABLE` / `WEFTEND_ADAPTER_DISABLE_FILE`) for `container`.
- Fail-closed precondition outcomes still write deterministic receipts (`safe_run_receipt.json`, `operator_receipt.json`).
- Output includes deterministic adapter artifacts:
  analysis/capability_ledger_v0.json
  analysis/adapter_summary_v0.json
  analysis/adapter_findings_v0.json
- Receipts include bounded counts/flags only (no timestamps or raw env values).

3.3) Shadow audit (CLI, proof-only)
- Run explicit shadow audit lane:
  npm run weftend -- shadow-audit <request.json>
- Output is deterministic proof-only JSON (`weftend.shadowAudit.result/0`) with:
  - reason families
  - sequence mismatch counts
  - capability mismatch counts
  - bounded tartarus kind counters
- No storage/export side effects are performed by default.

3.4) GitHub Actions artifact meter (optional)
- Included workflow:
  .github/workflows/weftend_artifact_meter.yml
- Run from Actions UI (`workflow_dispatch`) with:
  - target_path (required)
  - adapter (required)
  - baseline_path (optional)
- This executes deterministic `safe-run` (analysis-only, `--withhold-exec`) and optional compare.
- Workflow artifacts are uploaded under:
  out/ci_meter
- Included strict verify gate workflow:
  .github/workflows/weftend_verify360.yml
- Run from Actions UI (`workflow_dispatch`) to execute:
  npm run verify:360:release:managed
- Verify artifacts are uploaded under:
  out/verify_360_release_managed
- Details:
  docs/GITHUB_ACTIONS.md

4) Launchpad (no CLI after install)
- Open Start Menu -> WeftEnd Launchpad
- Add shortcuts/apps in:
  %LOCALAPPDATA%\WeftEnd\Library\Launchpad\Targets
- Click Sync, then run items from Launchpad.
- Behavior:
  - SAME vs baseline: launch allowed.
  - CHANGED/BLOCKED vs baseline: explicit accept/decline flow.

5) Bind/unbind to WeftEnd (right-click)
- Right-click a file/shortcut/folder:
  - Bind to WeftEnd
  - Unbind from WeftEnd
- For .lnk rewrap mode, WeftEnd preserves icon and can restore original shortcut state on unbind.

6) Open Library and ticket packs
- Right-click target -> Run with WeftEnd (Open Library)
- On CHANGED runs, WeftEnd can prompt to create a ticket pack.
- CLI alternative:
  npm run weftend -- library
  npm run weftend -- ticket-pack <outRoot> --out <ticketDir> --zip

7) Builder integration (for tools built on top)
- Export deterministic integration JSON:
  npm run weftend -- export-json <outRoot> --format normalized_v0
- Contract: weftend.normalizedSummary/0
- Policy/usage boundary: docs/POWERED_BY_WEFTEND.md

8) Portable bundle
- Open Start Menu -> WeftEnd Download
- Use weftend_*_portable.zip for field/offline operator use.
- Runtime is never auto-downloaded: bundled runtime/node/node.exe is preferred; local Node fallback is fail-closed.

9) Commit gate (contributors)
- Before any reusable commit:
  npm run verify:360
- Strict proofcheck with enforced release smoke fixture:
  npm run proofcheck:release
- Verify with strict adapter-maintenance gating enabled:
  npm run verify:360:adapter:strict
- Enforce non-zero exit on PARTIAL verdicts:
  npm run verify:360:enforce-partial
- Enforce both strict adapter gating and fail-on-partial:
  npm run verify:360:adapter:strict:enforced
- One-command release-grade strict gate (adapter strict + fail-on-partial + strict audit):
  npm run verify:360:release
  Note: strict audit fails on existing history warnings; use a clean `WEFTEND_360_OUT_ROOT` when needed.
- One-command strict release gate with clean dedicated out-root reset:
  npm run verify:360:release:cleanout
  Note: this still fails if strict adapter doctor finds unresolved missing-plugin requirements.
- Managed strict release gate (auto-generates temporary adapter maintenance policy for missing-plugin lanes):
  npm run verify:360:release:managed
  Note: generated policy is used for strict adapter-doctor preflight only; full `verify:360` then runs without global adapter-disable env leakage.
  Note: this helper enforces release smoke by setting `WEFTEND_RELEASE_DIR` (default `tests/fixtures/release_demo`) and clearing `WEFTEND_ALLOW_SKIP_RELEASE`.
- Optional corridor harness (pass/replay/forced-exception):
  npm run verify:360:harness
- Optional history audit:
  npm run verify:360:audit
- Strict history audit (warnings fail):
  npm run verify:360:audit:strict
- Note: non-strict audit may report legacy warnings on older history runs.
- This runs a full 360 verification pass (compile, test, proofcheck, deterministic replay, privacy lint, compare smoke).
- `verify:360` also runs a built-in non-strict history audit pass:
  - audit errors fail the gate
  - legacy history warnings are surfaced without forcing strict failure
- To enforce strict warning-fail behavior inside `verify:360`, set:
  WEFTEND_360_AUDIT_STRICT=1
- To enforce strict adapter maintenance/plugin checks inside `verify:360`, set:
  WEFTEND_360_ADAPTER_DOCTOR_STRICT=1
- To force non-zero exit on PARTIAL verdicts, set:
  WEFTEND_360_FAIL_ON_PARTIAL=1
- It always writes a verification receipt/report, including PARTIAL/FAIL outcomes:
  - out/verify_360/history/run_<seq>/verify_360_receipt.json
  - out/verify_360/history/run_<seq>/verify_360_report.txt
- Host precondition misses are recorded as explicit PARTIAL/SKIP evidence (analysis-first).
- Optional fixture overrides:
  - set WEFTEND_RELEASE_DIR for proofcheck release fixture path
  - set WEFTEND_360_INPUT for deterministic replay input path
  - set WEFTEND_360_OUT_ROOT for isolated verify output root (optional)
  - set WEFTEND_360_SAFE_RUN_ADAPTER to force adapter selection in verify deterministic safe-run pair (optional)

Notes
- No cloud. No telemetry. No malware scoring.
- Host execution is optional and off by default.
- Receipts are deterministic and privacy-clean.
- WeftEnd is evidence support; operators remain responsible for decisions (see docs/DISCLAIMER.md).
